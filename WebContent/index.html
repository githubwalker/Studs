<!DOCTYPE html>
<html lang="en">
<head>

    <link href="scripts/jquery-ui-1.11.4/jquery-ui.css" rel="stylesheet" type="text/css" />
    <link href="scripts/jtable.2.4.0/themes/metro/blue/jtable.css" rel="stylesheet" type="text/css" />
    <script src="scripts/jquery-2.2.0.js" type="text/javascript"> </script>
    <script src="scripts/jquery-ui-1.11.4/jquery-ui.js" type="text/javascript"> </script>
    <script src="scripts/jtable.2.4.0/jquery.jtable.js" type="text/javascript"></script>

</head>

<body>
<div id="PeopleTableContainer" style="width: 800px;"></div>

<b>Button with single icon</b><br/>
<button id="btnDemo"></button>


<!-- http://www.codeproject.com/Articles/594874/CRUD-tables-in-WebMatrix-using-jTable-jQuery-plugi -->

<script type="text/javascript">

    $(document).ready(function () {

        $('#PeopleTableContainer').jtable({
            title: 'Table of people',
            actions: {
                // listAction: 'PersonActions.php?action=list',
                // listAction: 'data/tbl.json'
                // listAction: 'C:/PROJECTS/js/1/data/tbl.json'
                listAction: 'crunchify/students/getall',
                // createAction: 'crunchify/students/append'

                createAction: function (postData) {

                    console.log('creating from custom function...');

                    return $.Deferred(function ($dfd) {

                        console.log('calling server ...');

                        $.ajax({
                            url: 'crunchify/students/append',
                            headers: {
                                'Accept': 'application/json',
                                'Content-Type': 'application/json'
                            },
                            type: 'POST',
                            dataType: 'json',
                            // dataType: 'application/json',
                            data: JSON.stringify(postData),
                            // data: '{ "Name" : "Iam", "Age" : 15 }',
                            success: function (data) {
                                console.log('success ...');
                                $dfd.resolve(data);
                            },
                            error: function () {
                                console.log('error ...');
                                $dfd.reject();
                            }
                        });
                    });
                }

            },
            fields: {
                Name: {
                    title: 'Author Name',
                    width: '40%'
                },
                Age: {
                    title: 'Age',
                    width: '20%'
                },
                PersonId: {
                    title: 'Person Id',
                    key: true,
                    create: false,
                    edit: false,
                    list: true
                }
            }
        });

        //Load person list from server
        $('#PeopleTableContainer').jtable('load');

        $("#btnDemo").button({
            label: 'Test'
        })
        .click(
            function( event ) {
                event.preventDefault();

                $.ajax({
                    url: 'crunchify/students/append',
                    type: 'POST',
                    dataType: 'json',
                    data: JSON.stringify('{"PersonId":1,"Name":"Benjamin Button","Age":17}'),
                    success: function (data) {
                        console.log('success ...');
                    },
                    error: function () {
                        console.log('error ...');
                    }
                });

            }
        )
        ;

    });

</script>

</body>
</html>
